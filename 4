import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LinearRegression, Ridge, Lasso
from sklearn.preprocessing import PolynomialFeatures, StandardScaler
from sklearn.pipeline import make_pipeline
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score, mean_squared_error, mean_absolute_error

np.random.seed(42)
area = np.linspace(500, 5000, 100)

price = 15 + 0.03 * area + 0.000001 * (area**2) + np.random.normal(0, 15, size=100)
df = pd.DataFrame({'Area_sqft': area, 'Price_Lakhs': price})

plt.figure(figsize=(8, 6))
sns.scatterplot(x='Area_sqft', y='Price_Lakhs', data=df)
plt.title("Non-linear Area vs Price with Noise")
plt.grid(True)
plt.show()
X = df[['Area_sqft']]
y = df['Price_Lakhs']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

lr = LinearRegression()
lr.fit(X_train, y_train)
y_pred_lr = lr.predict(X_test)
print(" Linear Regression:")
print("R²:", r2_score(y_test, y_pred_lr))
print("MAE:", mean_absolute_error(y_test, y_pred_lr))
print("RMSE:", np.sqrt(mean_squared_error(y_test, y_pred_lr)))

poly_model = make_pipeline(PolynomialFeatures(degree=2), LinearRegression())
poly_model.fit(X_train, y_train)
y_pred_poly = poly_model.predict(X_test)
print("\n Polynomial Regression (Degree 2):")
print("R²:", r2_score(y_test, y_pred_poly))
print("MAE:", mean_absolute_error(y_test, y_pred_poly))
print("RMSE:", np.sqrt(mean_squared_error(y_test, y_pred_poly)))

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)
X_train_s, X_test_s = train_test_split(X_scaled, test_size=0.2, random_state=42)

ridge = Ridge(alpha=10.0)
ridge.fit(X_train_s, y_train)
y_pred_ridge = ridge.predict(X_test_s)
print("\n  Ridge Regression:")
print("R²:", r2_score(y_test, y_pred_ridge))
print("MAE:", mean_absolute_error(y_test, y_pred_ridge))
print("RMSE:", np.sqrt(mean_squared_error(y_test, y_pred_ridge)))

lasso = Lasso(alpha=1.0)
lasso.fit(X_train_s, y_train)
y_pred_lasso = lasso.predict(X_test_s)
print ("\n Lasso Regression:")
print("R²:", r2_score(y_test, y_pred_lasso))
print("MAE:", mean_absolute_error(y_test, y_pred_lasso))
print("RMSE:", np.sqrt(mean_squared_error(y_test, y_pred_lasso)))
